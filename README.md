# Файловый наблюдатель с автоматической отправкой изменений в GitHub

## **Описание**

Этот проект представляет собой синхронизатор файлов, который отслеживает изменения в указанной директории и автоматически коммитит и пушит их в удалённый Git-репозиторий на GitHub. Это решение может быть полезным для синхронизации заметок в таких приложениях, как Obsidian, или для автоматического резервного копирования ваших файлов в репозиторий.

Основные возможности:
* Автоматическое отслеживание изменений файлов в реальном времени.
* Коммит изменений в локальный Git-репозиторий.
* Автоматическая отправка изменений в удалённый репозиторий на GitHub.
* Поддержка персональных токенов GitHub (PAT) для безопасной аутентификации.
* Легкая настройка и изоляция с помощью Docker.

## **Как использовать**

### **1. Установка зависимостей**

Перед началом работы установите необходимые зависимости (например, `chokidar`):

```bash
npm install
```
### **2. Запуск файлового наблюдателя**

```bash
node file_watcher_interval.js "Директория"
```

### **3. Как это работает**

#### **Коммит и пуш изменений:**

- Когда в отслеживаемой директории обнаруживается изменение, программа запускает таймер (по умолчанию 5 минут). Если в течение этого времени происходит ещё одно изменение, таймер не сбрасывается.
- После истечения времени таймера программа автоматически выполняет следующие действия:
    - Добавляет изменения в локальный Git (`git add .`).
    - Выполняет коммит с сообщением, содержащим текущие дату и время.
    - Выполняет `git push` для отправки изменений в удалённый репозиторий.

#### **Периодическая проверка на наличие изменений в удалённом репозитории:**

- Программа каждые 30 минут (по умолчанию) выполняет проверку изменений в удалённом репозитории с помощью команды `git fetch`.
- Если локальный репозиторий отстаёт от удалённого, программа автоматически выполняет `git pull`, чтобы подтянуть изменения.

#### **Конфигурация**

- **Задержка перед выполнением коммитов и пуша:** Задержка на выполнение коммитов и пуша составляет  5 минут по умолчанию. Этот параметр можно изменить в коде, изменив значение переменной `delayPush`.
- **Интервал проверки удалённых изменений:** Программа проверяет удалённый репозиторий каждые 30 минут (по умолчанию). Этот интервал можно изменить, изменив значение переменной `delayPull` или передав другой интервал в функцию `startRemoteCheckInterval`.


### **4. Docker**

* Создайте Personal Access Token на GitHub
* Подготовка перемнных окружения
  * WORK_DIRECTORY: Путь внутри контейнера к директории, которую нужно отслеживать. Обычно /app/watchdir.
  * GIT_TOKEN: Персональный токен доступа (PAT) от GitHub.
  * GIT_REPO: URL вашего репозитория на GitHub без протокола и токена, например: github.com/YourUsername/YourRepo.git.

#### **Сборка Docker-образа**

```bash copy 
docker build -t file-watcher .
```

#### **Запуск Docker-контейнера**

```bash copy 
docker run -d --name file-watcher \
  -e WORK_DIRECTORY=/app/watchdir \
  -e GIT_TOKEN="ваш_персональный_токен" \
  -e GIT_REPO="github.com/YourUsername/YourRepo.git" \
  -v "ПУТЬ_К_ВАШЕЙ_ДИРЕКТОРИИ":/app/watchdir \
  file-watcher
```

#### **Проверка работы**

```bash copy
  docker logs -f file-watcher
```

#### **Остановка и удаление контейнера**

```bash copy
  docker stop file-watcher   
```

```bash copy
  docker rm file-watcher 
```
